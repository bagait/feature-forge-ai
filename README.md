# Feature Forge AI

An AI agent that automatically discovers and engineers new features for tabular datasets using a Large Language Model (LLM).

This tool automates one of the most creative and time-consuming parts of the machine learning workflow: feature engineering. It analyzes an existing dataset and intelligently proposes, justifies, and generates code for new features that can improve model performance.



### Features

-   **Automated Discovery**: Uses an LLM to find non-obvious relationships in your data.
-   **Code Generation**: Automatically writes and executes pandas code to create new feature columns.
-   **Explainability**: Each new feature comes with a rationale from the AI, explaining why it might be useful.
-   **Iterative Process**: Can run multiple rounds of feature generation, building on previously created features.
-   **Local & Private**: Leverages [Ollama](https://ollama.com/) to run powerful LLMs on your local machine, keeping your data private.

## How It Works

Feature Forge AI uses a ReAct (Reason+Act) inspired loop to create features:

1.  **Analyze (Reason)**: The agent examines the schema and a sample of the current DataFrame. It creates a detailed prompt that asks an LLM to act as a data scientist.
2.  **Propose (Reason)**: The LLM analyzes the data summary and proposes 3 new features, providing a name, a description (the reasoning), and the Python/pandas code to generate it. The response is structured as JSON for reliable parsing.
3.  **Generate (Act)**: The agent parses the LLM's response. For each valid proposal, it executes the generated pandas code, adding the new feature column to the DataFrame.
4.  **Iterate**: The process can be repeated, allowing the agent to use the newly created features as a basis for even more complex ones.

## Installation

First, you need to install and run Ollama. Follow the instructions on [ollama.com](https://ollama.com/).

Once Ollama is running, pull a model that is good at coding and JSON formatting. We recommend `llama3:8b`.

bash
ollama pull llama3:8b


Next, clone this repository and install the Python dependencies:

bash
git clone https://github.com/bagait/feature-forge-ai.git
cd feature-forge-ai
pip install -r requirements.txt


## Usage

Run the main script. It will automatically create a `sample_data.csv`, run the feature generation process, and save the result to `augmented_data.csv`.

bash
python main.py


### Example Output

You will see the agent's reasoning and actions in real-time:


Welcome to Feature Forge AI! 
Please ensure the Ollama application is running in the background.
Creating sample data file: sample_data.csv

Loaded data from 'sample_data.csv'. Initial columns: ['user_id', 'age', 'signup_date', 'last_purchase_date', 'total_spent', 'items_purchased']

Starting feature generation with model: llama3:8b

--- Iteration 1/2 ---
Asking LLM to propose new features...

[1mâœ¨ Generating feature: spend_per_item[0m
   [90mâ””â”€ Rationale: Calculates the average amount spent per item, which could indicate user purchasing habits (e.g., preference for expensive vs. cheap items).[0m
   [92mâœ” Success! Column 'spend_per_item' added.[0m

[1mâœ¨ Generating feature: days_as_customer[0m
   [90mâ””â”€ Rationale: Measures the time since a user signed up, a common proxy for customer loyalty and lifetime value.[0m
   [92mâœ” Success! Column 'days_as_customer' added.[0m

[1mâœ¨ Generating feature: days_since_last_purchase[0m
   [90mâ””â”€ Rationale: Indicates user activity and recency. A high value might suggest a churn risk.[0m
   [92mâœ” Success! Column 'days_since_last_purchase' added.[0m

--- Iteration 2/2 ---
Asking LLM to propose new features...

[1mâœ¨ Generating feature: purchase_frequency_days[0m
   [90mâ””â”€ Rationale: Estimates how often a user makes a purchase on average (in days). A lower number indicates more frequent shopping.[0m
   [92mâœ” Success! Column 'purchase_frequency_days' added.[0m

...

Feature generation complete. Saving augmented data to 'augmented_data.csv'...

Final DataFrame head:
...


### Disclaimer

This project uses `exec()` to run code generated by an LLM. While the agent is designed to only generate pandas operations, executing AI-generated code carries inherent risks. Use this tool with caution and always review the generated code, especially when working with sensitive data or in production environments.

## License

This project is licensed under the MIT License.
